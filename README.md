# 3Dファイルビューアー (3D Model Viewer V2)

**GLB/GLTF/FBX/OBJ形式の3Dモデルファイルを表示する高機能Webアプリケーション**

## 🎯 概要

このアプリケーションは、Blenderなどで作成された3Dモデルファイルを、Webブラウザ上で直接表示・操作できるビューアーです。Three.jsを使用して高品質な3Dレンダリングを実現し、直感的な操作感を提供します。

## ✨ 主な機能

### 📁 対応ファイル形式
- **GLB/GLTF** - 標準的な3Dファイル形式
- **FBX** - Autodesk FBXファイル
- **OBJ** - Wavefront OBJファイル（MTLマテリアル対応）

### 🎮 操作機能
- **マウス操作**
  - 左ドラッグ: モデルの回転
  - 右ドラッグ: 上下左右移動
  - Shift+右ドラッグ: 前後移動（ズーム）
  - ホイール: 前後移動（ズーム）
- **キーボード操作**
  - 矢印キー: 上下左右移動
  - Rキー: カメラリセット
- **UI操作**
  - オブジェクト選択: クリックで選択
  - フォーカス機能: 選択オブジェクトへの自動ズーム
  - カメラリセット: 初期位置に戻す

### 🖼️ 表示機能
- **表示モード切り替え**
  - マテリアルモード: テクスチャ・マテリアル表示
  - ワイヤーフレームモード: 線枠表示
  - ソリッドモード: 単色表示
- **背景色変更**
  - カラーピッカーで任意の色を選択
  - プリセット色の選択
- **オブジェクト情報表示**
  - ファイル名、形式、オブジェクト数
  - マテリアル数、ポリゴン数、頂点数
- **アウトライナー**
  - 階層表示によるオブジェクト管理
  - 表示/非表示の切り替え
  - オブジェクトの選択・フォーカス

## 🚀 使用方法

### 1. ファイルの準備
1. 以下のいずれかのファイルを用意
   - GLB
   - GLTF
   - FBX
   - OBJ（MTLファイルも含む）

### 2. アプリケーションの起動
1. プロジェクトフォルダを開く
2. PowerShellまたはコマンドプロンプトで以下を実行：
   ```bash
   python -m http.server 8000
   ```
3. ブラウザで `http://localhost:8000` にアクセス

### 3. ファイルの読み込み
1. ファイルをドラッグ&ドロップ、または「ファイルを選択」ボタンをクリック
2. 対応形式のファイルを選択
3. 自動的に読み込まれ、3Dビューに表示

- サーバーを停止したい場合は、PowerShellで Ctrl + C を押してください。


## 📁 プロジェクト構成

```
app105_3dModelViewerV2/
├── index.html      # メインHTMLファイル（UI構造）
├── styles.css      # CSSスタイルファイル（デザイン・レイアウト）
├── script.js       # JavaScriptメインロジック（3D処理・操作）
└── README.md       # プロジェクト説明書（このファイル）
```

### ファイル構成の特徴
- **分離された構造**: HTML、CSS、JavaScriptが適切に分離
- **保守性**: 各ファイルが特定の責任を持つ明確な構造
- **スケーラビリティ**: 機能追加や修正が容易

## 🛠️ 技術スタック

### コア技術
- **Three.js v0.158.0**: 3Dグラフィックス・レンダリング
- **ES6 Modules**: import mapsによるモジュール管理
- **Tailwind CSS**: ユーティリティファーストCSS
- **HTML5 File API**: ファイル操作

### Three.jsローダー
- **GLTFLoader**: GLTF/GLB形式（推奨）
- **FBXLoader**: Autodesk FBX形式
- **OBJLoader**: Wavefront OBJ形式
- **MTLLoader**: マテリアルファイル

### 外部依存関係（CDN）
```javascript
// Three.js v0.158.0
"three": "https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.module.js"

// Tailwind CSS
https://cdn.tailwindcss.com

// Google Fonts (Inter)
https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap
```

## ✨ 主要機能

### ファイル対応
| 形式 | 拡張子 | 説明 | アニメーション | 推奨度 |
|------|--------|------|----------------|--------|
| **GLTF/GLB** | `.gltf`, `.glb` | 最新の3D標準形式 | ✅ | ⭐⭐⭐⭐⭐ |
| **FBX** | `.fbx` | Autodesk形式 | ✅ | ⭐⭐⭐⭐ |
| **OBJ** | `.obj` | 軽量メッシュ形式 | ❌ | ⭐⭐⭐ |

### 操作方法

#### マウス操作
- **左クリック+ドラッグ**: モデル回転
- **右クリック+ドラッグ**: 上下左右移動（パン）
- **Shift+右クリック+ドラッグ**: 前後移動（ズーム）
- **マウスホイール**: 前後移動（ズーム）
- **オブジェクトクリック**: オブジェクト選択

#### キーボード操作
- **矢印キー**: 上下左右移動
- **R**: カメラ位置リセット

#### UIコントロール
- **リセットボタン**: カメラ位置を初期状態に戻す
- **フォーカスボタン**: 選択したオブジェクトにズーム
- **新しいファイル**: 別のファイルを読み込み

### 表示モード

#### 🎨 マテリアル表示
- **特徴**: テクスチャ・マテリアル・色彩を完全表示
- **用途**: 最終的な見た目確認、プレゼンテーション
- **パフォーマンス**: 標準

#### 🔲 ワイヤーフレーム表示
- **特徴**: メッシュ構造を線で表示
- **用途**: モデリング確認、ポリゴン構造把握
- **パフォーマンス**: 高速

#### ⚫ ソリッド表示
- **特徴**: グレー単色で形状のみ表示
- **用途**: シルエット確認、形状把握
- **パフォーマンス**: 高速

### アウトライナー機能

#### 階層表示
- **ツリー構造**: オブジェクトの親子関係を表示
- **展開/折りたたみ**: 大規模シーンの管理
- **アイコン表示**: オブジェクトタイプの視覚化

#### オブジェクト操作
- **選択**: クリックでオブジェクト選択・ハイライト
- **表示/非表示**: 個別オブジェクトの表示制御
- **フォーカス**: 選択オブジェクトに自動ズーム

### ファイル情報表示
- **基本情報**: ファイル名、形式
- **統計情報**: オブジェクト数、マテリアル数
- **メッシュ情報**: ポリゴン数、頂点数

## 🎮 詳細操作ガイド

### カメラ制御
```
🖱️ 左ドラッグ       → 回転
🖱️ 右ドラッグ       → 上下左右移動
🖱️ Shift+右ドラッグ → 前後移動
🖱️ ホイール        → ズーム
⌨️ 矢印キー        → 移動
⌨️ R             → リセット
```

### 高度な操作
- **スムーズアニメーション**: カメラ移動の滑らかな補間
- **自動フィット**: モデル全体が画面に収まるよう自動調整
- **オブジェクト選択**: 3D空間でのレイキャスティング選択
- **ハイライト表示**: 選択オブジェクトのエッジ表示

## 📱 レスポンシブデザイン

### デスクトップ（768px以上）
- **全機能利用可能**: すべてのUI要素とコントロール
- **複数パネル**: 情報パネル、アウトライナー、コントロール
- **高解像度対応**: Retina/高DPIディスプレイ対応

### モバイル/タブレット（768px未満）
- **最適化UI**: 重要な機能に絞ったインターフェース
- **タッチ操作**: タッチ・ピンチ・スワイプ対応
- **簡潔レイアウト**: 画面サイズに応じた要素配置

## ⚙️ カスタマイズ

### スタイルカスタマイズ（styles.css）
```css
/* カラーテーマの変更 */
:root {
    --primary-color: #3b82f6;    /* ブルー系 */
    --background-dark: #0f172a;  /* ダーク背景 */
    --panel-bg: rgba(15, 23, 42, 0.95); /* パネル背景 */
}

/* アニメーション速度の調整 */
.display-mode-btn {
    transition: all 0.3s ease;   /* トランジション時間 */
}
```

### 機能カスタマイズ（script.js）
```javascript
// カメラ設定
this.camera = new THREE.PerspectiveCamera(
    60,     // 視野角（FOV）
    aspect, // アスペクト比
    0.1,    // ニアクリップ
    1000    // ファークリップ
);

// ライティング設定
const ambientLight = new THREE.AmbientLight(0xffffff, 0.4);  // 環境光
const directionalLight = new THREE.DirectionalLight(0xffffff, 1); // 指向性ライト
```

## 🔧 トラブルシューティング

### ファイル読み込みエラー
| 問題 | 原因 | 解決方法 |
|------|------|----------|
| ファイルが読み込めない | 非対応形式 | GLB/GLTF/FBX/OBJファイルを使用 |
| 読み込みが遅い | ファイルサイズが大きい | ファイルサイズを最適化 |
| テクスチャが表示されない | パスエラー | 相対パスでテクスチャを配置 |

### 表示・操作エラー
| 問題 | 原因 | 解決方法 |
|------|------|----------|
| 画面が真っ暗 | モデルサイズ問題 | カメラリセット（Rキー） |
| 操作が効かない | JavaScript無効 | ブラウザでJavaScriptを有効化 |
| 重い・カクつく | 高密度モデル | ワイヤーフレーム表示に切り替え |

### ブラウザ互換性
| ブラウザ | バージョン | 対応状況 |
|----------|------------|----------|
| **Chrome** | 90+ | ✅ 完全対応 |
| **Firefox** | 88+ | ✅ 完全対応 |
| **Safari** | 14+ | ✅ 完全対応 |
| **Edge** | 90+ | ✅ 完全対応 |

## 🚀 パフォーマンス最適化

### ファイル最適化
- **ポリゴン削減**: 不要な詳細を削除
- **テクスチャ圧縮**: 適切な解像度とフォーマット
- **GLB使用**: 最も効率的なフォーマット

### レンダリング最適化
- **LOD（Level of Detail）**: 距離に応じた詳細度調整
- **カリング**: 見えない部分の描画省略
- **シャドウ最適化**: 必要に応じてシャドウを無効化

## 🔒 セキュリティ

### 安全な使用
- **ローカル実行**: 信頼できるHTTPサーバーで実行
- **ファイル検証**: 信頼できるソースからのファイルのみ使用
- **CORS対応**: 適切なオリジン設定

---

**3D Model Viewer V2** - プロフェッショナルな3Dファイル表示ソリューション